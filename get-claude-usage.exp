#!/usr/bin/expect -f

# Expect script to get usage from Claude Code
set timeout 10

# Start Claude
spawn claude

# Wait for prompt
expect {
    "*desktop_bot*" { }
    "How can I help*" { }
    "claude>*" { }
    ">*" { }
    timeout {
        puts "Failed to get Claude prompt"
        exit 1
    }
}

# Send /usage command
send "/usage\r"

# Wait for response
expect {
    "*%*" {
        set output $expect_out(buffer)
    }
    timeout {
        puts "No usage response"
        exit 1
    }
}

# Print the output for parsing
puts "OUTPUT_START"
puts $output
puts "OUTPUT_END"

# Exit
send "exit\r"
expect eof